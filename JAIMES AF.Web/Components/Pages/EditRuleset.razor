@page "/rulesets/{RulesetId}/edit"
@rendermode InteractiveServer

<PageTitle>Edit Ruleset</PageTitle>

<MudContainer MaxWidth="MaxWidth.Medium" Class="mt-4">
	<FormPageHeader Title="@(_isLoading ? "Edit Ruleset" : $"Edit: {_name}")"
	                Icon="@Icons.Material.Filled.AutoStories"
	                Theme="FormPageHeader.HeroTheme.Accent"
	                Subtitle="Modify ruleset configuration" />

	<MudPaper Class="pa-6" Elevation="2">
        <MudStack Row="true" AlignItems="AlignItems.Center" Class="mb-4">
            <MudBreadcrumbs Items="_breadcrumbs" Separator=">"></MudBreadcrumbs>
        </MudStack>

		@if (_isLoading)
		{
			<MudProgressCircular Indeterminate="true" Class="my-4"/>
		}
		else if (!string.IsNullOrEmpty(_errorMessage))
		{
			<MudAlert Severity="Severity.Error" Class="mb-4">@_errorMessage</MudAlert>
		}

		@if (!_isLoading && !string.IsNullOrEmpty(_errorMessage) && _errorMessage.Contains("not found"))
		{
			<MudButton Variant="Variant.Text" Color="Color.Primary" Href="/rulesets" Class="mt-2">
				Back to Rulesets
			</MudButton>
		}

		@if (!_isLoading && string.IsNullOrEmpty(_errorMessage))
		{
			<MudForm>
				<MudTextField Value="@RulesetId"
				              Label="Ruleset ID"
				              Variant="Variant.Outlined"
				              Class="mb-4"
				              Disabled="true"
				              HelperText="Ruleset ID cannot be changed"/>

				<MudTextField @bind-Value="_name"
				              Label="Name"
				              Variant="Variant.Outlined"
				              Class="mb-4"
				              Disabled="_isSaving"
				              Required="true"
				              RequiredError="Name is required"/>

				<MudTextField @bind-Value="_description"
				              Label="Description"
				              Variant="Variant.Outlined"
				              Class="mb-4"
				              Disabled="_isSaving"
				              Lines="3"
				              HelperText="Optional description for this ruleset"/>

				<FormActionButtons PrimaryText="Save Changes"
				                   PrimaryColor="Color.Success"
				                   PrimaryIcon="@Icons.Material.Filled.Check"
				                   OnPrimary="UpdateRulesetAsync"
				                   PrimaryDisabled="@(!IsFormValid())"
				                   IsSaving="_isSaving"
				                   CancelHref="@($"/rulesets/{RulesetId}")" />
			</MudForm>
		}
	</MudPaper>
</MudContainer>

